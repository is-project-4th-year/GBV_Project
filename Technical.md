
---

# **SpeakSafe – GBV Detection System with Explainable AI**

**Technical Documentation**

**Final Year Project Report – 2025**

**Author:** sharly.misati@strathmore.edu

**Model:** Hybrid Ensemble (TweetNLP + Multinomial Naïve Bayes) with LIME Explainability

**Platform:** Streamlit + Firebase Authentication



---

# **1. Executive Summary**

SpeakSafe is an explainable AI system designed to detect and categorize **five major forms of Gender-Based Violence (GBV)** in online text, focusing on content from social media platforms such as **X (Twitter)**. The system helps users identify harmful digital abuse patterns—including **sexual**, **physical**, **emotional**, **economic**, and **harmful traditional practices**—and provides contextual **support resources** based on Kenyan and UN GBV assistance services.

The model integrates a **TweetNLP transformer model** with a classical **Naïve Bayes classifier** into a **hybrid ensemble**, producing highly accurate and interpretable predictions. SpeakSafe uses **LIME** to highlight keywords that influenced the classifier, enabling transparency for researchers, activists, and everyday users.

The system includes a modern, secure **Streamlit interface**, full **Firebase authentication**, Twitter API scraping, and a full Explainability & Support dashboard.

---

# **2. System Approach**

## **2.1 Data Preprocessing**

SpeakSafe uses annotated GBV datasets sourced from open-source research corpora and supplemented with curated manually annotated samples. Each text sample was cleaned using:

* Lowercasing
* URL and emoji stripping
* Stopword removal
* Tokenization
* Removal of repeated characters and noise
* Length filtering (>10 characters)

The final dataset was split as follows:

| Split          | Samples |
| -------------- | ------- |
| **Training**   | 70%     |
| **Validation** | 20%     |
| **Testing**    | 10%     |

Preprocessing pipeline implemented in `preprocess.py`.

---

## **2.2 Model Architecture**

### **Hybrid Classification Ensemble**

SpeakSafe combines the strengths of transformer embeddings with statistical classifiers:

| Component                | Description                                                          |
| ------------------------ | -------------------------------------------------------------------- |
| **TweetNLP Transformer** | Used for contextual GBV embedding extraction (HuggingFace pipeline). |
| **TF-IDF + Naïve Bayes** | Classical classifier for lexical-level abuse detection.              |
| **Soft Voting Layer**    | Combines probability outputs from both models.                       |

This approach ensures:

* Strong contextual understanding (transformer)
* Robust performance on short/noisy tweets (Naïve Bayes)
* Balanced interpretability and accuracy

---

## **2.3 Feature Engineering**

Features include:

### **Transformer Features**

* 768-dim TweetNLP contextual embeddings
* Fine-grained understanding of abusive semantic cues

### **Statistical Features**

Generated by TF-IDF vectorizer (`tfidf_vectorizer.joblib`) including:

* Word unigrams & bigrams
* Term frequency weighting
* Abuse-associated vocabulary detection

### **Explainability**

LIME highlights:

* Words linked to each GBV class
* Weight contribution per token
* Color-coded explanation overlays

---

# **3. System Architecture**

A lightweight, deployable, modular architecture:

1. **Frontend (Streamlit)**

   * Login
   * Text input + Tweet scraping
   * Explainability view
   * Support resource recommendations

2. **Backend**

   * Ensemble inference engine
   * Preprocessing utilities
   * LIME explainer

3. **Auth Layer**

   * Firebase Authentication
   * Secure session handling

4. **External Integrations**

   * Twitter API v2 for tweet scraping

---

# **4. Implementation Details**

## **4.1 Repository Structure**

```
GBV_PROJECT/
├── app.py
├── preprocess.py
├── lime_functions.py
├── shap_utils.py
├── config.yaml
├── requirements.txt
├── README.md
├── assets/images/
│   ├── login.png
│   ├── dashboard.png
│   └── explanations.png
├── models/
│   ├── naive_bayes_model.joblib
│   ├── tfidf_vectorizer.joblib
│   └── tweetnlp/
├── GBV_Model.ipynb
├── GBV_RNN.ipynb
├── GBV_Deep_Neural_Networks.ipynb
└── .streamlit/
    └── secrets.toml
```

---

# **5. Evaluation & Testing**

## **5.1 Testing Paradigm**

Testing followed **white-box + black-box hybrid evaluation**, appropriate for NLP systems.

* **White-box testing:** verified tokenization, vectorization, and ensemble probability outputs.
* **Black-box testing:** fed raw tweets and text excerpts to the system to observe predicted categories, explanations, and resource recommendations.

---

## **5.2 Quantitative Evaluation**

The held-out test dataset produced the following results:

### **Table 1: Model Performance Metrics**

| Metric        | Score |
| ------------- | ----- |
| **Accuracy**  | 0.87  |
| **Precision** | 0.84  |
| **Recall**    | 0.86  |
| **F1-Score**  | 0.85  |


### **Category-Level Performance**

| GBV Category                  | Precision | Recall | F1-Score |
| ----------------------------- | --------- | ------ | -------- |
| Sexual Violence               | 0.82      | 0.85   | 0.83     |
| Physical Violence             | 0.88      | 0.87   | 0.87     |
| Emotional Abuse               | 0.84      | 0.89   | 0.86     |
| Economic Violence             | 0.80      | 0.72   | 0.76     |
| Harmful Traditional Practices | 0.86      | 0.83   | 0.84     |


---

## **5.3 Qualitative Testing**

Random user inputs were analyzed using the interface. The LIME explanations highlighted high-influence words such as:

* “beat”, “hurt”, “force” → *physical violence*
* “insult”, “threaten”, “shame” → *emotional abuse*
* “denied money”, “control wages” → *economic violence*

The system consistently produced clear and interpretable highlights.

---

# **6. User Interface (Screenshots)**

### **6.1 Login Page**

Coming Soon
**Figure X.X: SpeakSafe Login Interface**

### **6.2 Dashboard (Tweet Input + URL Scraper)**

Coming Soon
**Figure X.X: Main Analysis Dashboard**

### **6.3 Explainability & Support Resources**

Coming Soon
**Figure X.X: LIME Explanation with Resource Panel**

---

# **7. Support Resources Provided**

When the system detects GBV, it provides the following contextual help:

### **Kenya National Hotlines**

* **Toll-Free GBV Hotline:** 1195
* **Kenya Police Emergency:** 999 / 112
* **Childline Kenya:** 116
* **National GBV Helpline:** 0 800 720 186

### **Medical & Support Centers**

* **Gender Violence Recovery Centre (GVRC)** – Nairobi Women’s Hospital
* **Healthcare Assistance Kenya (HAK)**

### **Global Resources**

* **UN Women GBV Helpline**
* **UNFPA Safe Spaces Network**
* **UNHCR GBV Protection Clusters**

Mappings are tailored per GBV category.

---

# **8. Deployment**

### **Environment**

* HP Envy (Windows 11)
* Python 3.9 virtual environment
* Streamlit 1.29
* Firebase Admin SDK
* HuggingFace TweetNLP

### **Local Execution**

```
streamlit run app.py
```

---

# **9. Challenges Faced**

* Twitter API rate limits
* Class imbalance in GBV subcategories
* Transformer inference slower for long texts
* LIME slow on longer sentences → optimized using word windows

---

# **10. Conclusion**

SpeakSafe successfully demonstrates the application of **Explainable AI**, **NLP**, and **hybrid machine learning techniques** toward addressing GBV in online spaces. By combining TweetNLP transformers, Naïve Bayes, and interpretable LIME explanations, the system provides trustworthy, actionable feedback to users facing online harm.

The inclusion of **Kenyan national resources**, **UN support centers**, and **emergency hotlines** strengthens its direct social impact and ensures users receive practical, immediate help.

This work establishes a foundation for future research and development in **ethical AI for digital safety**, with strong opportunities for expansion.

---

# **11. Future Work**

* Deploy as Chrome extension for real-time social media scanning
* Add Swahili language support
* Integrate sentiment trajectory graphs
* Add community reporting + moderation features
* Deploy scalable backend (FastAPI + Docker + Cloud Run)

---
